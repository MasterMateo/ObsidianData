#SystemDesign 

Не брать остаток от деления на количество хостов, в брать значения по кругу(как на часах). Мы знаем на кругу где и в каком месте у нас расположен каждый шард, данные располагаются на интервалах между числами. Для перемещения данных, в случае добавление шардов, достаточно сделать full scan только по одному "сектору" круга и перенести эти данные в нужное место.

[[consistent-hashing]] 

> При таком подходе обязательно надо учесть реакцию системы на каскадный сбой! Если 1 из 3 шардов упадет, то нагрузка с него пойдет на следующий и так они могут рухнуть по цепочке 

Можно на круге располагать виртуальные шарды - [[abstruct-consistent-hashing]]. В таком случае, при отказе одного из шардов у нас выпадает сразу несколько небольших интервалов, соответственно нагрузка распределится на соседние виртуальные шарды. Получается, что чем больше у нас виртуальных шардов, тем больше интервалов с данными, которые выпадают при отказе, и тем больше шардов, на которые распределяется нагрузка. Размазывая данные по бакетам мы обеспечиваем отказоустойчивость(плюс данные будут распределены равномернее)
