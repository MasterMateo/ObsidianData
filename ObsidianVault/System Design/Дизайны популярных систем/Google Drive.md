#SystemDesign 

### Функциональные требования
- сохранение \ загрузка \ удаление файлов
- создание каталога для файлов

### Нефункциональные требования
- DAU 50 000 000
- Avaliability 99.95%
- Read : write ratio 1:1
- Максимальный размер файла 100ГБ
- Пользователь имеет 100 файлов со средним размером 1 МБ
- Пользователь обращается к файлам 6 раз в день
- Геораспределенности нет
- Нет сезонности


Чтобы обрабатывать файлы размером 100ГБ, необходимо будет разбить их на чанки(chunk). 
Преимущества:
- Более грамотное распределение файлов по хранилищам
- Возможность продолжить выгрузку файла с того же места в случае падения сети
- Не хранить дубликаты, можно просто ссылаться на них(дедупликация)

### Как делать дедупликацию?

CAS - Content Addressable Storage
В таком хранилище файлы называются хешом, хеш считается на основании содержания файла(не его названия). 
- sd12fgt44 => chunk
- 1233jlto45 => chunk
Коллизии можно разрешать, например, с помощью double hashing(считаем хеш функцию два раза)

>[!info]- Что делать с большим трафиком?
> На данном примере мы получаем ~4GB/s, что не мало, но и нельзя сказать что значение запредельное. Балансировщик может прогнать через себя такую нагрузку. 
> 
> Если бы трафика было больше то:
> - Редирект пользователя на отдельный upload сервер
> - Клиентская балансировка

0 20 28........