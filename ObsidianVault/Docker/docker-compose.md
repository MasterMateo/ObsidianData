#Docker 

*docker-compose* - Инструмент для того чтобы объявлять и запускать множество контейнеров Докера
*Dockerfile* - описывает то как мы будет билдить наш образ(image)
```docker#
FROM node:13

WORKDIR /usr/src/app

COPY package*.json ./

RUN npm install

COPY ..

EXPOSE 3000

CMD ["node", "run start"]
````
- `FROM node:13` - Описывает с какого образа мы хотим создать свой образ. *Dockerfile* отвечает за то как этот сервис будет собираться в *docker image*
- `WORKDIR` путь к рабочей папке внутри контейнера
- `COPY` - тут прописываются файлы, которые будут скопированы внутрь docker контейнера, когда мы его создадим
- `RUN` - после того как будут скопированы файлы из поля `COPY`, будет запущена команда из этого поля внутри контейнера
- `COPY ..` - значит, что мы хотим все файлы проекта были скопированы внутрь контейнера (что исключить копирование файлов нужно создать `.dockerignore` и в нем прописать исключения)
- `EXPOSE` - номер порта(!)
- `CMD` - команда для запуска сервиса(!)
	- ! - однако не стоит писать эти два поля в *Dockerfile*, мы хотим прописывать порты и команды на уровне файла *docker-compose*, это позволит поразному конфигурировать сервер(т.е. делаем stateless file)

*docker image* - образ линукса, мы берем какой-то образ линукс и с нее создаем наш контейнер ( в контейнере будет доступно все, что есть в образе линукс)

```docker#
version: '3' 
services:
	api:
		build: ./api
		command: npm run start
		restart: unless-stop
		ports:
			- "3000:3000"
		enviroments:
			-PORT=3000
			-HOST=http://realworld-docker.com
			-MONGO_URL=mongodb://api_db:27017/api
		depends_on:
			-api_db
	api_db:
		image: mongo:latest
		volumes:
			-mongodb_api:/data/db
volumes:
	mongodb_api:
````

1. version - Версионирование docker-compose и то какие поля можно использовать внутри этого `.yml` файла 
2. services - сервисы для форнтэенда, бэкенда, бд, мэйлера и тд. Тут описываются все сервисы, которые docker-compose должен сбилдить
3. api - имя сервиса (сами придумываем)
	1. build - путь до папки, из которой docker-compose будет брать docker файл для билда сервиса (тут он будет брать его из папки `api`)
	2. command - команда, которая выполнится при старте нашего сервиса
	3. restart - параметры перезапуска контейнера в случае его падения
	4. ports - какие порты будут доступны снаружи (в примере мы открываем наружу порт 3000, слева наша машина, справа порт контейнера)
	5. environments - [[Переменные окружения]]
	6. depends_on - приоритет запуска сервисов
4. api_db - имя очередного сервиса
	1. image - тут мы указываем образ последней mongo 
	2. volumes - указываем путь, по которому будут храниться данные вне контейнера(т.к. при каждом перезапуске данные удаляются)

==docker-compose build== - билд контейнера
==docker-compose up== - запуск контейнера
